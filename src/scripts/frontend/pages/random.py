import streamlit as st
import pandas as pd

training_file_loc = 's3://sisyphus-general-bucket/AthenaInsights/latest_data/model/data/stock_bars_1min_base_avg_base_rsi_base_macd_base_otherfeatures_base_avg.parquet'
x = pd.read_parquet(training_file_loc, columns=['close', 'day_of_year'])

st.write(x.head())
st.write(x.tail(70985))
st.write(x.tail(70985).shape)




#  open: double high: double low: double close: double volume: double trade_count: double vwap: double market_open: bool symbol1: string open_ema_2m: double open_sma_2m: double high_ema_2m: double high_sma_2m: double low_ema_2m: double low_sma_2m: double close_ema_2m: double close_sma_2m: double volume_ema_2m: double volume_sma_2m: double trade_count_ema_2m: double trade_count_sma_2m: double vwap_ema_2m: double vwap_sma_2m: double open_ema_3m: double open_sma_3m: double high_ema_3m: double high_sma_3m: double low_ema_3m: double low_sma_3m: double close_ema_3m: double close_sma_3m: double volume_ema_3m: double volume_sma_3m: double trade_count_ema_3m: double trade_count_sma_3m: double vwap_ema_3m: double vwap_sma_3m: double open_ema_5m: double open_sma_5m: double high_ema_5m: double high_sma_5m: double low_ema_5m: double low_sma_5m: double close_ema_5m: double close_sma_5m: double volume_ema_5m: double volume_sma_5m: double trade_count_ema_5m: double trade_count_sma_5m: double vwap_ema_5m: double vwap_sma_5m: double open_ema_8m: double open_sma_8m: double high_ema_8m: double high_sma_8m: double low_ema_8m: double low_sma_8m: double close_ema_8m: double close_sma_8m: double volume_ema_8m: double volume_sma_8m: double trade_count_ema_8m: double trade_count_sma_8m: double vwap_ema_8m: double vwap_sma_8m: double open_ema_12m: double open_sma_12m: double high_ema_12m: double high_sma_12m: double low_ema_12m: double low_sma_12m: double close_ema_12m: double close_sma_12m: double volume_ema_12m: double volume_sma_12m: double trade_count_ema_12m: double trade_count_sma_12m: double vwap_ema_12m: double vwap_sma_12m: double open_ema_10m: double open_sma_10m: double high_ema_10m: double high_sma_10m: double low_ema_10m: double low_sma_10m: double close_ema_10m: double close_sma_10m: double volume_ema_10m: double volume_sma_10m: double trade_count_ema_10m: double trade_count_sma_10m: double vwap_ema_10m: double vwap_sma_10m: double open_ema_20m: double open_sma_20m: double high_ema_20m: double high_sma_20m: double low_ema_20m: double low_sma_20m: double close_ema_20m: double close_sma_20m: double volume_ema_20m: double volume_sma_20m: double trade_count_ema_20m: double trade_count_sma_20m: double vwap_ema_20m: double vwap_sma_20m: double open_ema_26m: double open_sma_26m: double high_ema_26m: double high_sma_26m: double low_ema_26m: double low_sma_26m: double close_ema_26m: double close_sma_26m: double volume_ema_26m: double volume_sma_26m: double trade_count_ema_26m: double trade_count_sma_26m: double vwap_ema_26m: double vwap_sma_26m: double close_7window_rsi: double close_9window_rsi: double close_11window_rsi: double close_14window_rsi: double close_17window_rsi: double close_21window_rsi: double close_ema_2m_7window_rsi: double close_ema_2m_9window_rsi: double close_ema_2m_11window_rsi: double close_ema_2m_14window_rsi: double close_ema_2m_17window_rsi: double close_ema_2m_21window_rsi: double close_sma_2m_7window_rsi: double close_sma_2m_9window_rsi: double close_sma_2m_11window_rsi: double close_sma_2m_14window_rsi: double close_sma_2m_17window_rsi: double close_sma_2m_21window_rsi: double Signal_close_ema_2m_close_ema_2m_7window_rsi_signal11: double Signal_close_ema_2m_close_ema_2m_9window_rsi_signal11: double Signal_close_ema_2m_close_ema_2m_11window_rsi_signal11: double Signal_close_ema_2m_close_ema_2m_14window_rsi_signal11: double Signal_close_ema_2m_close_ema_2m_17window_rsi_signal11: double Signal_close_ema_2m_close_ema_2m_21window_rsi_signal11: double Signal_close_ema_2m_7window_rsi_close_ema_2m_9window_rsi_signal11: double Signal_close_ema_2m_7window_rsi_close_ema_2m_11window_rsi_signal11: double Signal_close_ema_2m_7window_rsi_close_ema_2m_14window_rsi_signal11: double Signal_close_ema_2m_7window_rsi_close_ema_2m_17window_rsi_signal11: double Signal_close_ema_2m_7window_rsi_close_ema_2m_21window_rsi_signal11: double Signal_close_ema_2m_9window_rsi_close_ema_2m_11window_rsi_signal11: double Signal_close_ema_2m_9window_rsi_close_ema_2m_14window_rsi_signal11: double Signal_close_ema_2m_9window_rsi_close_ema_2m_17window_rsi_signal11: double Signal_close_ema_2m_9window_rsi_close_ema_2m_21window_rsi_signal11: double Signal_close_ema_2m_11window_rsi_close_ema_2m_14window_rsi_signal11: double Signal_close_ema_2m_11window_rsi_close_ema_2m_17window_rsi_signal11: double Signal_close_ema_2m_11window_rsi_close_ema_2m_21window_rsi_signal11: double Signal_close_ema_2m_14window_rsi_close_ema_2m_17window_rsi_signal11: double Signal_close_ema_2m_14window_rsi_close_ema_2m_21window_rsi_signal11: double Signal_close_ema_2m_17window_rsi_close_ema_2m_21window_rsi_signal11: double Signal_close_ema_2m_close_ema_2m_7window_rsi_signal13: double Signal_close_ema_2m_close_ema_2m_9window_rsi_signal13: double Signal_close_ema_2m_close_ema_2m_11window_rsi_signal13: double Signal_close_ema_2m_close_ema_2m_14window_rsi_signal13: double Signal_close_ema_2m_close_ema_2m_17window_rsi_signal13: double Signal_close_ema_2m_close_ema_2m_21window_rsi_signal13: double Signal_close_ema_2m_7window_rsi_close_ema_2m_9window_rsi_signal13: double Signal_close_ema_2m_7window_rsi_close_ema_2m_11window_rsi_signal13: double Signal_close_ema_2m_7window_rsi_close_ema_2m_14window_rsi_signal13: double Signal_close_ema_2m_7window_rsi_close_ema_2m_17window_rsi_signal13: double Signal_close_ema_2m_7window_rsi_close_ema_2m_21window_rsi_signal13: double Signal_close_ema_2m_9window_rsi_close_ema_2m_11window_rsi_signal13: double Signal_close_ema_2m_9window_rsi_close_ema_2m_14window_rsi_signal13: double Signal_close_ema_2m_9window_rsi_close_ema_2m_17window_rsi_signal13: double Signal_close_ema_2m_9window_rsi_close_ema_2m_21window_rsi_signal13: double Signal_close_ema_2m_11window_rsi_close_ema_2m_14window_rsi_signal13: double Signal_close_ema_2m_11window_rsi_close_ema_2m_17window_rsi_signal13: double Signal_close_ema_2m_11window_rsi_close_ema_2m_21window_rsi_signal13: double Signal_close_ema_2m_14window_rsi_close_ema_2m_17window_rsi_signal13: double Signal_close_ema_2m_14window_rsi_close_ema_2m_21window_rsi_signal13: double Signal_close_ema_2m_17window_rsi_close_ema_2m_21window_rsi_signal13: double Signal_close_ema_2m_close_ema_2m_7window_rsi_signal17: double Signal_close_ema_2m_close_ema_2m_9window_rsi_signal17: double Signal_close_ema_2m_close_ema_2m_11window_rsi_signal17: double Signal_close_ema_2m_close_ema_2m_14window_rsi_signal17: double Signal_close_ema_2m_close_ema_2m_17window_rsi_signal17: double Signal_close_ema_2m_close_ema_2m_21window_rsi_signal17: double Signal_close_ema_2m_7window_rsi_close_ema_2m_9window_rsi_signal17: double Signal_close_ema_2m_7window_rsi_close_ema_2m_11window_rsi_signal17: double Signal_close_ema_2m_7window_rsi_close_ema_2m_14window_rsi_signal17: double Signal_close_ema_2m_7window_rsi_close_ema_2m_17window_rsi_signal17: double Signal_close_ema_2m_7window_rsi_close_ema_2m_21window_rsi_signal17: double Signal_close_ema_2m_9window_rsi_close_ema_2m_11window_rsi_signal17: double Signal_close_ema_2m_9window_rsi_close_ema_2m_14window_rsi_signal17: double Signal_close_ema_2m_9window_rsi_close_ema_2m_17window_rsi_signal17: double Signal_close_ema_2m_9window_rsi_close_ema_2m_21window_rsi_signal17: double Signal_close_ema_2m_11window_rsi_close_ema_2m_14window_rsi_signal17: double Signal_close_ema_2m_11window_rsi_close_ema_2m_17window_rsi_signal17: double Signal_close_ema_2m_11window_rsi_close_ema_2m_21window_rsi_signal17: double Signal_close_ema_2m_14window_rsi_close_ema_2m_17window_rsi_signal17: double Signal_close_ema_2m_14window_rsi_close_ema_2m_21window_rsi_signal17: double Signal_close_ema_2m_17window_rsi_close_ema_2m_21window_rsi_signal17: double Signal_close_ema_2m_close_ema_2m_7window_rsi_signal20: double Signal_close_ema_2m_close_ema_2m_9window_rsi_signal20: double Signal_close_ema_2m_close_ema_2m_11window_rsi_signal20: double Signal_close_ema_2m_close_ema_2m_14window_rsi_signal20: double Signal_close_ema_2m_close_ema_2m_17window_rsi_signal20: double Signal_close_ema_2m_close_ema_2m_21window_rsi_signal20: double Signal_close_ema_2m_7window_rsi_close_ema_2m_9window_rsi_signal20: double Signal_close_ema_2m_7window_rsi_close_ema_2m_11window_rsi_signal20: double Signal_close_ema_2m_7window_rsi_close_ema_2m_14window_rsi_signal20: double Signal_close_ema_2m_7window_rsi_close_ema_2m_17window_rsi_signal20: double Signal_close_ema_2m_7window_rsi_close_ema_2m_21window_rsi_signal20: double Signal_close_ema_2m_9window_rsi_close_ema_2m_11window_rsi_signal20: double Signal_close_ema_2m_9window_rsi_close_ema_2m_14window_rsi_signal20: double Signal_close_ema_2m_9window_rsi_close_ema_2m_17window_rsi_signal20: double Signal_close_ema_2m_9window_rsi_close_ema_2m_21window_rsi_signal20: double Signal_close_ema_2m_11window_rsi_close_ema_2m_14window_rsi_signal20: double Signal_close_ema_2m_11window_rsi_close_ema_2m_17window_rsi_signal20: double Signal_close_ema_2m_11window_rsi_close_ema_2m_21window_rsi_signal20: double Signal_close_ema_2m_14window_rsi_close_ema_2m_17window_rsi_signal20: double Signal_close_ema_2m_14window_rsi_close_ema_2m_21window_rsi_signal20: double Signal_close_ema_2m_17window_rsi_close_ema_2m_21window_rsi_signal20: double Signal_close_ema_2m_close_ema_2m_7window_rsi_signal26: double Signal_close_ema_2m_close_ema_2m_9window_rsi_signal26: double Signal_close_ema_2m_close_ema_2m_11window_rsi_signal26: double Signal_close_ema_2m_close_ema_2m_14window_rsi_signal26: double Signal_close_ema_2m_close_ema_2m_17window_rsi_signal26: double Signal_close_ema_2m_close_ema_2m_21window_rsi_signal26: double Signal_close_ema_2m_7window_rsi_close_ema_2m_9window_rsi_signal26: double Signal_close_ema_2m_7window_rsi_close_ema_2m_11window_rsi_signal26: double Signal_close_ema_2m_7window_rsi_close_ema_2m_14window_rsi_signal26: double Signal_close_ema_2m_7window_rsi_close_ema_2m_17window_rsi_signal26: double Signal_close_ema_2m_7window_rsi_close_ema_2m_21window_rsi_signal26: double Signal_close_ema_2m_9window_rsi_close_ema_2m_11window_rsi_signal26: double Signal_close_ema_2m_9window_rsi_close_ema_2m_14window_rsi_signal26: double Signal_close_ema_2m_9window_rsi_close_ema_2m_17window_rsi_signal26: double Signal_close_ema_2m_9window_rsi_close_ema_2m_21window_rsi_signal26: double Signal_close_ema_2m_11window_rsi_close_ema_2m_14window_rsi_signal26: double Signal_close_ema_2m_11window_rsi_close_ema_2m_17window_rsi_signal26: double Signal_close_ema_2m_11window_rsi_close_ema_2m_21window_rsi_signal26: double Signal_close_ema_2m_14window_rsi_close_ema_2m_17window_rsi_signal26: double Signal_close_ema_2m_14window_rsi_close_ema_2m_21window_rsi_signal26: double Signal_close_ema_2m_17window_rsi_close_ema_2m_21window_rsi_signal26: double open_lag_1: double high_lag_1: double low_lag_1: double close_lag_1: double open_lag_2: double high_lag_2: double low_lag_2: double close_lag_2: double open_lag_3: double high_lag_3: double low_lag_3: double close_lag_3: double open_lag_4: double high_lag_4: double low_lag_4: double close_lag_4: double open_lag_5: double high_lag_5: double low_lag_5: double close_lag_5: double open_lag_6: double high_lag_6: double low_lag_6: double close_lag_6: double open_lag_7: double high_lag_7: double low_lag_7: double close_lag_7: double open_lag_8: double high_lag_8: double low_lag_8: double close_lag_8: double open_lag_9: double high_lag_9: double low_lag_9: double close_lag_9: double open_lag_10: double high_lag_10: double low_lag_10: double close_lag_10: double open_lag_11: double high_lag_11: double low_lag_11: double close_lag_11: double open_lag_12: double high_lag_12: double low_lag_12: double close_lag_12: double open_lag_13: double high_lag_13: double low_lag_13: double close_lag_13: double open_lag_14: double high_lag_14: double low_lag_14: double close_lag_14: double open_lag_15: double high_lag_15: double low_lag_15: double close_lag_15: double price_change: double direction: string cumulative_ups: int64 cumulative_downs: int64 direction_change_up_to_down: bool direction_change_down_to_up: bool prev_cumulative_ups: double prev_cumulative_downs: double hour: int32 minute: int32 day_of_year: int32 local_max_5: bool local_min_5: bool cumulative_local_max_5: int64 cumulative_local_min_5: int64 time_since_prev_max_5: int64 time_since_prev_min_5: int64 local_max_10: bool local_min_10: bool cumulative_local_max_10: int64 cumulative_local_min_10: int64 time_since_prev_max_10: int64 time_since_prev_min_10: int64 local_max_15: bool local_min_15: bool cumulative_local_max_15: int64 cumulative_local_min_15: int64 time_since_prev_max_15: int64 time_since_prev_min_15: int64 local_max_30: bool local_min_30: bool cumulative_local_max_30: int64 cumulative_local_min_30: int64 time_since_prev_max_30: int64 time_since_prev_min_30: int64 max_today: double min_today: double max_today_session: double min_today_session: double category: string future_highs: double future_lows: double slopes: double us_eastern_timestamp: timestamp[ns] __fragment_index: int32 __batch_index: int32 __last_in_fragment: bool __filename: string